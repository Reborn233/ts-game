!function(t){var e={};function s(i){if(e[i])return e[i].exports;var h=e[i]={i,l:!1,exports:{}};return t[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)s.d(i,h,function(e){return t[e]}.bind(null,h));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=7)}({7:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),s(8).default.run()},8:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=document.documentElement.clientWidth,h=document.documentElement.clientHeight,r=i>500?500:i,l=h,o=document.createElement("canvas");o.width=r,o.height=l;const n=o.getContext("2d");document.getElementById("app").appendChild(o);const c=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;class a{constructor(){}update(t){}render(t){const{x:e,y:s,width:i,height:h,color:r="white"}=this;n.fillStyle=r,n.fillRect(e,s,i,h)}}const u=[0,100,200,300];class f extends a{constructor(){super(),this.left=u[1],this.right=u[2],this.width=99,this.height=50,this.color="#fff",this.y=o.height-4*this.height}render(){const{left:t,right:e,y:s,height:i,width:h,color:r}=this;n.fillStyle=r,n.fillRect(t,s,h,i),n.fillRect(e,s,h,i)}move(t,e){switch(t){case"left":this.left=u[e];break;case"right":this.right=u[e]}}reset(){this.left=u[1],this.right=u[2]}}class d extends a{constructor(t=10){super(),this.width=99,this.height=20,this.left=c(0,100)%2==0?0:100,this.right=c(0,100)%2==0?200:300,this.y=0,this.highlight=!1,this.speedY=t}update(t){this.y+=this.speedY}offscreen(){return this.y>l}render(){const{width:t,height:e,left:s,right:i,y:h}=this;n.fillStyle="lime",this.highlight&&(n.fillStyle="red"),n.fillRect(s,h,t,e),n.fillRect(i,h,t,e)}hits(t){return t.y<this.y+this.height&&t.y+t.height>this.y+this.height&&(t.left===this.left||t.right===this.right)?(this.highlight=!0,!0):(this.highlight=!1,!1)}}class p extends a{constructor(){super(),this.x=0,this.y=0,this.width=o.width,this.height=o.height,this.color="black"}}e.default=new class{constructor(t=60){this.stop=!0,this.fps=t,this.score=0,this.msg="点击屏幕开始",this.frameCount=0,this.bg=new p,this.player=new f,this.walls=[],this.speed=5,o.addEventListener("touchstart",this.touchstart.bind(this)),o.addEventListener("touchend",this.touchend.bind(this))}run(){this.update(),this.clear(),this.draw(),setTimeout(()=>{this.run()},1e3/this.fps)}update(){if(this.frameCount++,!this.stop&&!this.over)for(let t=this.walls.length-1;t>=0;t--){const e=this.walls[t];e.update(this),e.hits(this.player)&&this.gameOver(),e.offscreen()&&(this.walls.splice(t,1),this.score++)}}clear(){n.clearRect(0,0,o.width,o.height)}draw(){this.bg.render();for(let t=this.walls.length-1;t>=0;t--)this.walls[t].render();if(this.player.render(),this.renderScore(),!this.stop){const t=this.walls[this.walls.length-1];t?t.y>180-this.speed&&(this.score>0&&this.score%3==0&&(this.speed+=5),this.walls.push(new d(5))):this.walls.push(new d(5))}}setScore(t){this.score=t}renderScore(){n.font="30px Georgia",n.fillStyle="white",n.fillText(this.score+"",20,30),(this.stop||this.over)&&(n.fillStyle="red",n.fillText(this.msg,r/2,l/2),n.textAlign="center")}gameOver(){this.msg="游戏结束",this.over=!0}start(){!1!==this.stop&&(this.stop=!1,this.score=0,this.walls=[],this.player.reset(),this.speed=5)}pause(){this.stop=!this.stop,this.msg="暂停"}touchstart(t){if(t.preventDefault(),this.start(),!this.stop)for(const e of t.touches){const{clientX:t,clientY:s}=e;s>l/2&&t<r/2?this.player.move("left",0):s>l/2&&t>r/2&&this.player.move("right",3)}}touchend(t){if(t.preventDefault(),this.stop)return;const e=[];for(const s of t.touches){const{clientX:t,clientY:i}=s;i>l/2&&t<r/2?e.push("left"):i>l/2&&t>r/2&&e.push("right")}e.indexOf("left")>-1?this.player.move("left",0):this.player.move("left",1),e.indexOf("right")>-1?this.player.move("right",3):this.player.move("right",2)}keyPush(t){switch(t.keyCode){case 65:this.player.move("left",0);break;case 83:this.player.move("right",3);break;case 49:this.start();break;case 50:this.pause()}}keyUp(t){switch(t.keyCode){case 65:this.player.move("left",1);break;case 83:this.player.move("right",2)}}}}});